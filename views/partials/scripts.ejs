<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.5.8/angular.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.5.0/d3.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/nvd3/1.8.5/nv.d3.js"></script>
<script>
	var weatherData = '', displayData = '';
	function getForecast(callback) {
		$.get("/forecast/lae", function (data) {
			console.log(data.city.name)
			callback(data);
		})
	}
	
	function createGraph() {
		nv.addGraph(function() {
			var chart = nv.models.lineChart()
				.margin({left: 100})
				// .userInteractiveGuideline(true)
				// .transitionDuration(350)
				.showLegend(true)
				.showYAxis(true)
				.showXAxis(true);
			chart.xAxis
				.axisLabel("Time (ms)")
				.tickFormat(d3.format('r'));
			chart.yAxis
				.axisLabel("Voltage (v)")
				.tickFormat(d3.format('.02f'));
			displayData = sortWeatherData();
			var lineChart = d3.select("#forecastGraph").append("svg");
			lineChart.datum(displayData)
				.call(chart);
		});
	}
	
	function sortWeatherData() {
		var threeHourly = [];
		for (var i=0; i<weatherData.list.length; i++) {
			// threeHourly.push({x: i, y: weatherData.list[i].temp.day});
			threeHourly.push({x: weatherData.list[i].dt_txt, y: weatherData.list[i].main.temp});
		}
		return [{
			values: threeHourly,
			key: 'Date',
			color: 'cadetblue'
		}];
	}

	$(document).ready(function() {
		// getForecast(function(data){
			// data ? displayData = data: console.log("err");
			createGraph();
			// weatherData = data;
			console.log(data);
			// return data;
		// })
	});
</script>